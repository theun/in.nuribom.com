<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Daum에디터 - 이미지 첨부</title> 
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script>
<script src="../../js/popup.js" type="text/javascript" charset="utf-8"></script>
<link rel="stylesheet" type="text/css" href="/static/plupload/js/jquery.plupload.queue/css/jquery.plupload.queue.css" charset="utf-8"/>
<script type="text/javascript" src="/static/plupload/js/plupload.full.js"></script>
<script type="text/javascript" src="/static/plupload/js/jquery.plupload.queue/jquery.plupload.queue.js"></script>
<link rel="stylesheet" href="../../css/popup.css" type="text/css"  charset="utf-8"/>
<script type="text/javascript">
// <![CDATA[
	
	function done() {
		if (typeof(execAttach) == 'undefined') { //Virtual Function
	        return;
	    }
		
		var uploader = $("#html5_uploader").pluploadQueue()
		for (var i = 0; i < uploader.files.length; i++) {
			if (uploader.files[i].status == plupload.DONE) {
	            var _mockdata = {
                    'imageurl': '/images/' + uploader.files[i].id,
                    'filename': uploader.files[i].name,
                    'filesize': uploader.files[i].size,
                    'imagealign': 'L',
                    'originalurl': '/images/' + uploader.files[i].id,
                    'thumburl': '/images/' + uploader.files[i].id
                };
                execAttach(_mockdata);
			}
		}
		closeWindow();
	}

	function initUploader(){
	    var _opener = PopupUtil.getOpener();
	    if (!_opener) {
	        alert('잘못된 경로로 접근하셨습니다.');
	        return;
	    }
	    
	    var _attacher = getAttacher('image', _opener);
	    registerAction(_attacher);
	}
// ]]>


	// Convert divs to queue widgets when the DOM is ready
	$(function() {
	    // Setup html5 version
	    $("#html5_uploader").pluploadQueue({
	        // General settings
	        runtimes : 'html5',
	        url : '/upload/images',
	        max_file_size : '10gb',
	        chunk_size : '4mb',
	        //unique_names : true,
	        dragdrop : true,

	        // Resize images on clientside if we can
	        resize : {width : 320, height : 240, quality : 90},

	        // Specify what files to browse for
	        filters : [
	            {title : "Image files", extensions : "jpg,gif,png"},
	            {title : "Zip files", extensions : "zip"}
	        ]
	    });
	    $("#html5_uploader").pluploadQueue().bind('BeforeUpload', function(up, file) {
	    	up.settings.multipart_params = {id: file.id}
	    });
	    $("#html5_uploader").pluploadQueue().bind('UploadComplete', done)
	});

</script>
</head>
<body onload="initUploader();">
<div class="wrapper">
	<div class="header">
		<h1>사진 첨부</h1>
	</div>	
	<div class="body">
		<dl class="alert">
		    <dt>사진 첨부 확인</dt>
		    <dd>
                <div id="html5_uploader" style="height: 330px; position: relative; ">
                    <div class="plupload_wrapper plupload_scroll">
                        <div id="html5_uploader_container" class="plupload_container">
                            <div class="plupload">
                                <div class="plupload_header">
                                    <div class="plupload_header_content">
                                        <div class="plupload_header_title">Select files</div>
                                        <div class="plupload_header_text">Add files to the upload queue and click the start button.</div>
                                    </div>
                                </div>
                                <div class="plupload_content">
                                    <div class="plupload_filelist_header">
                                        <div class="plupload_file_name">Filename</div>
                                        <div class="plupload_file_action">&nbsp;</div>
                                        <div class="plupload_file_status">
                                            <span>Status</span>
                                        </div>
                                        <div class="plupload_file_size">Size</div>
                                        <div class="plupload_clearer">&nbsp;</div>
                                    </div>
                                    <ul id="html5_uploader_filelist" class="plupload_filelist">
                                        <li class="plupload_droptext">Drag files here.</li>
                                    </ul>
                                    <div class="plupload_filelist_footer">
                                        <div class="plupload_file_name">
                                            <div class="plupload_buttons">
                                                <a href="#" class="plupload_button plupload_add" id="html5_uploader_browse" style="position: relative; z-index: 0; ">Add files</a>
                                                <a href="#" class="plupload_button plupload_start plupload_disabled">Start upload</a>
                                            </div>
                                            <span class="plupload_upload_status"></span>
                                        </div>
                                        <div class="plupload_file_action"></div>
                                        <div class="plupload_file_status">
                                            <span class="plupload_total_status">0%</span>
                                        </div>
                                        <div class="plupload_file_size">
                                            <span class="plupload_total_file_size">0 b</span>
                                        </div>
                                        <div class="plupload_progress">
                                            <div class="plupload_progress_container">
                                                <div class="plupload_progress_bar"></div>
                                            </div>
                                        </div>
                                        <div class="plupload_clearer">&nbsp;</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="html5_uploader_count" name="html5_uploader_count" value="0">
                    </div>
                    <div id="p16uf325mmj2kqu3tuc4gfrt44_html5_container" style="
	                        position: absolute; 
	                        background-image: initial; 
	                        background-attachment: initial; 
	                        background-origin: initial; 
	                        background-clip: initial; 
	                        background-color: transparent; 
	                        overflow-x: hidden; 
	                        overflow-y: hidden; 
	                        opacity: 0; 
	                        top: 292px; 
	                        left: 16px; 
	                        width: 75px; 
	                        height: 22px; 
	                        z-index: -1; 
	                        background-position: initial initial; 
	                        background-repeat: initial initial; " class="plupload html5">
                        <input id="p16uf325mmj2kqu3tuc4gfrt44_html5" style="
                            font-size: 999px; 
                            position: absolute; 
                            width: 100%; 
                            height: 100%; " type="file" accept="image/jpeg,image/gif,image/png,application/zip" multiple="multiple">
                    </div>
                </div>
        	</dd>
		</dl>
	</div>
</div>
</body>
</html>